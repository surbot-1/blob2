<!DOCTYPE html>

<html lang=”en”>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Document</title>
</head>
  
<body>
  
  <!--
  <input class="FullWidth" type="file" name="mtlFileInput" value="" id="mtlFileInput" 
  onchange="readMtlAtClient()" accept=".mtl"/> <br>
  -->
<input type="file" name="file" id="file">
<textarea rows="10" cols="50" id="textField"></textarea>
<button onclick="saveFile()">Save</button>
<br><br> <button onclick="submitFile()">Submit</button>
   
  <div id="div4"> </div>
  <div id="div5"> </div>
  <div id="div6"> </div>
  <div id="div7"> </div>
  <div id="div8"> </div>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  
  <script>
    
    // function saveFile() { }
    // function downloadFile() { }
    
    
  /* function readMtlAtClient(){

       mtlFileContent = '';

       var mtlFile = document.getElementById('mtlFileInput').files[0];
       var readerMTL = new FileReader();

       // Closure to capture the file information.
       readerMTL.onload = (function(reader) {
           return function() {
               mtlFileContent = reader.result;
               mtlFileContent = mtlFileContent.replace('data:;base64,', '');
               mtlFileContent = window.atob(mtlFileContent);

           };
       })(readerMTL);

       readerMTL.readAsDataURL(mtlFile);
   } */
</script>
  
  
<script> 

  

 /*   //Create a 16byte buffer 

    var buffer = new ArrayBuffer(16); 

  

    //Create a DataView referring to the buffer 

    var view1 = new DataView(buffer); 

  

    //Create a Int8Array view referring to the buffer 

    var view2 = new Int8Array(buffer); 

  

    //Put value of 32bits 

    view1.setInt32(0, 0x76543210); 

  

    //prints the 32bit value 

    document.write(view1.getInt32(0).toString(16) + "<br>");  

      

    //prints only 8bit value  

    document.write(view1.getInt8(0).toString(16) + "<br>");  

    document.write(view2[0].toString(16)); 
     */
  
  </script>
  
  
<script>
    
  var a, b, c, d ;
  
   
  
   
  
/* function readFile(event) {
    textarea.textContent = event.target.result ;
    console.log(event.target.result);
   // const blob = new Blob([new Uint8Array(event.target.result)], {type: file.type });
    // console.log(blob);
    // textarea.textContent = blob ;
    // document.querySelector('#div4') = blob ;
  } */
  
  
  /*
  var input = document.querySelector('input[type=file]');
  var textarea = document.querySelector('textarea');
input.addEventListener('change', changeFile); 
function changeFile() {
   /* //
    var input = document.querySelector('input[type=file]');
    var textarea = document.querySelector('textarea');
    // var blob;
    var file = input.files[0];
    var reader = new FileReader();
       //  reader.addEventListener('load', readFile);
      // reader.readAsText(file); 
      // reader.readAsArrayBuffer(file);
      //  reader.readAsDataURL(file);
    reader.onload = function(e) {
      var blob = new Blob([new Uint8Array(e.target.result)], {type: file.type });
       console.log(blob);
        // var text = await blob.text() ;
       textarea.textContent = e.target.result;
       document.querySelector('#div4').innerHTML += "<br>"+ e.target.result ;
       
      // blob.text().then(text => {
       // let blobText = text;
      // document.querySelector('#div5').innerHTML += "<br>" + blobText ;
      // });
     } 
      reader.readAsDataURL(file); 
     } */
    
    
       
/*  // var reader = new FileReader();
  reader.readAsText(blob); alert('readBlob');
  reader.addEventListener('loadend', () => {
   // reader.result contains the contents of blob as a typed array
  textarea.textContent = reader.result ; alert(reader.result);
  }); */
  
    //
  /*  const file = document.querySelector('input[type=file]').files[0];
    const reader = new FileReader();
    reader.onload = function(e) {
    const blob = new Blob([new Uint8Array(e.target.result)], {type: file.type });
    console.log(blob);
    document.querySelector('#div4') = blob ;
    }
    reader.readAsArrayBuffer(file); */
    //
  /*  const file = document.querySelector('input[type=file]').files[0];
    file.arrayBuffer().then((arrayBuffer) => {
    const blob = new Blob([new Uint8Array(arrayBuffer)], {type: file.type });
    console.log(blob);
    document.querySelector('#div4') = blob ;
    }); */
    //
   /* const fileToBlob = async (file) => new Blob([new Uint8Array(await file.arrayBuffer())], {type: file.type });
    console.log(await fileToBlob(new File(['hello', ' ', 'world'], 'hello_world.txt', {type: 'text/plain'}))); */
  



  
  
/*  // Convert file to base64 string
export const fileToBase64 = (filename, filepath) => {
  return new Promise(resolve => {
    var file = new File([filename], filepath);
    var reader = new FileReader();
    // Read file content on file loaded event
    reader.onload = function(event) {
      resolve(event.target.result);
    }
    
    // Convert data to base64 
    reader.readAsDataURL(file);
  });
}
// Example call:
fileToBase64("test.pdf", "../files/test.pdf").then(result => {
  console.log(result);
}); */
    
  
/*  var url = URL.createObjectURL(blob);
  
  const reader = new FileReader();
  reader.readAsArrayBuffer(blob);
  reader.addEventListener('loadend', () => {
   // reader.result contains the contents of blob as a typed array
  });
  
  const text = await (new Response(blob)).text();
  
  const text = await blob.text();  */
  
  
 /*  var mystring = "Hello World!";
   var myblob = new Blob([mystring], {
    type: 'text/plain'
   });
   mystring = "";
   
   var reader = new FileReader();
   reader.onload = function() {
   alert(reader.result);
   }
   reader.readAsText(blob); 
   
   const text = await new Response(blob).text() */
  
   /* function blobToString(b) {
    var u, x;
    u = URL.createObjectURL(b);
    x = new XMLHttpRequest();
    x.open('GET', u, false); // although sync, you're not fetching over internet
    x.send();
    URL.revokeObjectURL(u);
    return x.responseText;
    } 
    var b = new Blob(['hello world']);
    blobToString(b); // "hello world" */
    
  /*  var mystring = "Hello World!";
    var myblob = new Blob([mystring], {
    type: 'text/plain'
    });
    mystring = "";
    outurl = URL.createObjectURL(myblob);
    fetch(outurl)
    .then(res => res.text())
    .then(data => {
    console.log(data)
    }) */
  
 /*  blob.text().then(text => {
   let blobText = text
   }) */
  
  

  /* var buffer = new ArrayBuffer(16);
  var view1 = new DataView(buffer);
  var view2 = new Int8Array(buffer);
  view1.setInt32(0, 0x76543210);
  document.write(view1.getInt32(0).toString(16) + "<br>"); 
  document.write(view1.getInt8(0).toString(16) + "<br>"); 
  document.write(view2[0].toString(16)); */
  
  
  /*   const buffer = new ArrayBuffer(8);
     const view = new DataView(buffer);
     view.setInt8(0, 0xAB);
     var x = view.getInt8(0).toString(8);
     document.write(x); */
  
 /* // create an ArrayBuffer with a size in bytes
const buffer = new ArrayBuffer(16);

// Create a couple of views
const view1 = new DataView(buffer);
const view2 = new DataView(buffer, 12, 4); //from byte 12 for the next 4 bytes
view1.setInt8(12, 42); // put 42 in slot 12

console.log(view2.getInt8(0));
// expected output: 42  */
  
/* new DataView(buffer)
new DataView(buffer, byteOffset)
new DataView(buffer, byteOffset, byteLength) */

/*  var buffer = new ArrayBuffer(16);
  var view = new DataView(buffer, 0);

  view.setInt16(1, 42);
  view.getInt16(1); // 42 */

  
  /* function dataURLtoFile(dataurl, filename) {
 
        var arr = dataurl.split(','),
            mime = arr[0].match(/:(.*?);/)[1],
            bstr = atob(arr[1]), 
            n = bstr.length, 
            u8arr = new Uint8Array(n);
            
        while(n--){
            u8arr[n] = bstr.charCodeAt(n);
        }
        
        return new File([u8arr], filename, {type:mime});
    }
    
    //Usage example:
    var file = dataURLtoFile('data:text/plain;base64,aGVsbG8gd29ybGQ=','hello.txt');
    console.log(file);  */
  
  
 /* //return a promise that resolves with a File instance
    function urltoFile(url, filename, mimeType){
        return (fetch(url)
            .then(function(res){return res.arrayBuffer();})
            .then(function(buf){return new File([buf], filename,{type:mimeType});})
        );
    }
    
    //Usage example:
    urltoFile('data:text/plain;base64,aGVsbG8gd29ybGQ=', 'hello.txt','text/plain')
    .then(function(file){ console.log(file);}); */
  
  
  /* const url = 'data:image/png;base6....';
   fetch(url)
  .then(res => res.blob())
  .then(blob => {
    const file = new File([blob], "File name",{ type: "image/png" })
   }) */
  
  
   /* export async function dataUrlToFile(dataUrl: string, fileName: string): Promise<File> {

    const res: Response = await fetch(dataUrl);
    const blob: Blob = await res.blob();
    return new File([blob], fileName, { type: 'image/png' });
    } */
  
  
   /* const imgName = incomingImage['FileName'];
    const imgExt = imgName.split('.').pop();
    let mimeType = 'image/png';
    if (imgExt.toLowerCase() !== 'png') {
    mimeType = 'image/jpeg';
    }
    const imgB64 = incomingImage['_@ttribute'];
    const bstr = atob(imgB64);
    let n = bstr.length;
    const u8arr = new Uint8Array(n);
    while (n--) {
    u8arr[n] = bstr.charCodeAt(n);
    }
    const file = new File([u8arr], imgName, {type: mimeType});  */
  
  
   /* dataUrlToFile(dataUrl: string, filename: string): File | undefined {

    const arr = dataUrl.split(',');

    if (arr.length < 2) { return undefined; }

    const mimeArr = arr[0].match(/:(.*?);/);

    if (!mimeArr || mimeArr.length < 2) { return undefined; }

    const mime = mimeArr[1];

    const buff = Buffer.from(arr[1], 'base64');

    return new File([buff], filename, {type:mime});

  }
  import { Buffer } from 'buffer';
  const file = new File([
  new Blob(["decoded_base64_String"])
  ], "output_file_name");  */
  
  alert('1');
  
  
  function typedArrayToURL(typedArray, mimeType) {
  return URL.createObjectURL(new Blob([typedArray.buffer], {type: mimeType})) ;
}

const bytes = new Uint8Array(59);

for(let i = 0; i < 59; i++) {
  bytes[i] = 32 + i;
}

const url = typedArrayToURL(bytes, 'text/plain');

const link = document.createElement('a');
link.href = url; 
link.innerText = 'Open the array URL';

document.body.appendChild(link);
  


    
    
       
  
  
  function saveFile() {
  
   var text2 = "ABCD";
   var  blob2 = new Blob( new Uint8Array[text2], {type: "text/plain " }) ;
   var reader2 = new FileReader();
   reader2.onload = function(eve) {
 
   var buf2 = eve.target.result ;
   var bufView2 = new Uint8Array(buf2);
  // // var bufffer = eve.target.result ;
  
    
        var  buffer2 = new ArrayBuffer(16);
        var view2 = new DataView(buffer);
        view2.setInt8(0,bufView2[0]);
        view2.setInt8(1,bufView2[1]);
    document.getElementById("div5").innerHTML += "<br>" + eve.target.result;
    document.getElementById("div5").innerHTML += "<br>" + bufView2 ;
    document.getElementById("div5").innerHTML += "<br>" + view2.getInt8(0);
   }
   reader2.readAsArrayBuffrr(blob2); 
  
  }
  
   alert('2');
  
  
  </script>
  
  
  
  <script>
  
 // function submitFile() {
  
     
    
     
    var input = document.getElementById("file");
    var output = document.getElementById("textField");
input.addEventListener("change", function () {
  
     document.getElementById("div4").innerHTML += "<br>" + " File Reading... " ;
     
     var data, blob;
  if (this.files && this.files[0]) {
    var file = this.files[0];
    var reader = new FileReader();
    
    reader.addEventListener('load', function (e) {
           blob = new Blob([new Uint8Array (e.target.result) ], {type: " text/plain " }) ;
           data = e.target.result ;
           var buf = e.reader.result ;
           var bufView = new Uint8Array(buf);
           output.textContent = e.target.result; 
           document.getElementById("div5").innerHTML += "<br>" + e.target.result ;
           document.getElementById("div5").innerHTML += "<br>" + bufView ;
           document.getElementById("div5").innerHTML += "<br>" + blob ;
          });
          reader.readAsArrayBuffer(file);
          }   
      });
    
     
 
    

   
   /*  reader = new FileReader();
     reader.onload = fuction () {
            // textarea.setContent = reader.result ;
            blob = new Blob([new Uint8Array (target.result) ], {type:  file.type  }) ;
           document.getElementById("div5").innerHTML += "<br>" + target.result ;
           document.getElementById("div5").innerHTML += "<br>" + blob ;
           }
          reader.readAsArrayBuffer(file); */
  
/*  function submitFile() {
    var reader = new FileReader();
    reader.onload = function() {
           var buf = reader.result ;
           var bufView = new Uint8Array(buf);
           // var  buffer = new ArrayBuffer(16);
           // var view = new DataView(buffer);
           // view.setInt8(0,bufView[0]);
           // view.setInt8(1,bufView[1]);
           document.getElementById("div5").innerHTML += "<br>" + reader.result;
           document.getElementById("div5").innerHTML += "<br>" + bufView ;
           // document.getElementById("div5").innerHTML += "<br>" + view.getInt8(0);
           }
          reader.readAsArrayBuffer(blob);
        } */
   
  
  
  
 /* function saveFile() {
        var abc = "hello world" ;
    // file = document.querySelector('input[type=file]').files[0];
     var reader = new FileReader();
     reader.onload = function() {
        document.getElementById("div5").innerHTML += "<br>" + reader.result ;
      
       var content = reader. result ; //"hello world" ;  // reader.result;
        var fileType = "text/plain;charset=utf-8" ;
        
        var blob = new Blob([content], { type: fileType });
         
        document.getElementById("div5").innerHTML += "<br>" + blob ;
         var filename = "abc.txt";
          saveAs(blob, filename); 
      }
      reader.readAsDataURL(abc);
    } */
  
  
/*  var content = bytes // "What's up , hello world";
// any kind of extension (.txt,.cpp,.cs,.bat)
var filename = "hello.txt";
var blob2 = new Blob([content], {
type: "text/plain;charset=utf-8"
 });
 saveAs(blob2, filename); 
    */


  
  
  
  
/*  // create an ArrayBuffer with a size in bytes
const buffer = new ArrayBuffer(16);

// Create a couple of views
const view1 = new DataView(buffer);
const view2 = new DataView(buffer, 12, 4); //from byte 12 for the next 4 bytes
view1.setInt8(12, 42); // put 42 in slot 12

console.log(view2.getInt8(0));
// expected output: 42 */
  
  
  // reader.readAsText(file); 
   // reader.readAsArrayBuffer(file); 
  //  reader.readAsDataURL(file);
    
 // reader.readAsBinaryString(file);
    
/* function convert() {
   var buf = [0x02, 0x01, 0x03, 0x07] ;
  function ab2str(buf) {
  return String.fromCharCode.apply(null, new Uint16Array(buf));
  }
function str2ab(str2) {
  var buf2 = new ArrayBuffer(str.length*2); // 2 bytes for each char
  var bufView = new Uint16Array(buf);
  for (var i=0, strLen=str.length; i < strLen; i++) {
    bufView[i] = str.charCodeAt(i);
    }
  return buf;
  }
}  */
  
    
  
/*  var content = "What's up , hello world";
// any kind of extension (.txt,.cpp,.cs,.bat)
var filename = "hello.txt";

var blob = new Blob([content], {
 type: "text/plain;charset=utf-8"
});

saveAs(blob, filename); */
  
  
  
</script>
  
</body>
</html>
